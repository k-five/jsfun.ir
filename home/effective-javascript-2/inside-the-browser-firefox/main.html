<main>
	<div class="content-r">
		<h1>inside-the-browser-firefox</h1>
        <hr>
        <p>Today we are going to look at inside a web browser which is Firefox.</p>
        <p>All the time we talk about JavaScript, JavaScript and today we see where is this JavaScript.</p>
        <p>If you have opened Firefox, closed it completely.</p>
        <p>Then open you Terminal.</p>
        <p>Then open your Firefox and do not do anything with it. It should have one tab opened.</p>
        
        <h3 class="sub-title">Processes</h3>
        <p>On you Terminal type:</p>
<pre><code class="language-javascript">pidof firefox | tr ' ' '\n' | sort -h

// which gives you something like this
4084
5282
5597
5822</code></pre>
        <p>The first one <strong>4084</strong> is the parent process id.</p>
        <p>The second one is the child process id which is active tab we have.</p>
        <p>The other two are also children and are reserved processes.</p>

        <h3 class="sub-title">Parent and Children</h3>
        <p>We can see the them in tree mode of the <strong>ps</strong> command.</p>
        <p>try:</p>
<pre><code class="language-javascript"> ps -ocmd,ppid,pid,nlwp,state --forest $(pidof firefox)

// output
CMD                          PPID   PID NLWP S
/usr/lib/firefox/firefox        1  4084   52 S    // parent
 \_ /usr/lib/firefox/firefo  4084  5282   21 S    // active child
 \_ /usr/lib/firefox/firefo  4084  5597   20 S
 \_ /usr/lib/firefox/firefo  4084  5822   19 S</code></pre>
        <p>Also those options are:</p>
        <ul>
            <li><strong>cmd</strong>: command that is running</li>
            <li><strong>ppid</strong>: parent process id</li>
            <li><strong>pid</strong> process id</li>
            <li><strong>nlwp</strong> number of threads a process has</li>
            <li><strong>state</strong> the sate of a process which here is <strong>S</strong> and means sleep.</li>
            <li><strong>--forest</strong>: show the output in tree mode</li>
        </ul>
        <p>More info about "state" option:</p>
<pre><code class="language-javascript">D    uninterruptible sleep (usually IO)
R    running or runnable (on run queue)
// ours
S    interruptible sleep (waiting for an event to complete)
T    stopped by job control signal
t    stopped by debugger during the tracing
W    paging (not valid since the 2.6.xx kernel)
X    dead (should never be seen)
Z    defunct ("zombie") process, terminated but not reaped by its parent</code></pre>

        <h3 class="sub-title">Threads</h3>
        <p>For seeing where is JavaScript we have show the threads inside a child process.</p>
        <p>Try this command, looking at threads inside <strong>5282</strong> process</p>
<pre><code class="language-javascript">ps -T -p 5282

// which gives us this output
  PID  SPID TTY          TIME CMD
 5282  5282 ?        00:00:02 Web Content
 5282  5298 ?        00:00:00 Chrome_~dThread
 5282  5300 ?        00:00:00 JS Watchdog
 5282  5301 ?        00:00:00 JS Helper
 5282  5302 ?        00:00:00 JS Helper
 5282  5303 ?        00:00:00 Socket Thread
 5282  5304 ?        00:00:00 Timer
 5282  5316 ?        00:00:00 DOM File
 5282  5317 ?        00:00:00 Worker Launcher
 5282  5318 ?        00:00:00 PaintThread
 5282  5334 ?        00:00:00 ImgDecoder #1
 5282  5335 ?        00:00:00 ImageIO
 5282  5357 ?        00:00:00 ImageBr~geChild
 5282  5358 ?        00:00:00 RemVidChild
 5282  5359 ?        00:00:00 AudioIPC0
 5282  5360 ?        00:00:00 AudioIPC1
 5282  5367 ?        00:00:00 ProcessHangMon
 5282  5368 ?        00:00:00 ProfilerChild
 5282  5383 ?        00:00:00 HTML5 Parser
 5282  5774 ?        00:00:00 ImgDecoder #2</code></pre>

        <p>For us the important stuff here are:</p>
<pre><code class="language-javascript"> ...
 5282  5300 ?        00:00:00 JS Watchdog
 5282  5301 ?        00:00:00 JS Helper
 5282  5302 ?        00:00:00 JS Helper
 ...
 5282  5304 ?        00:00:00 Timer
 ...</code></pre>
        
        <h3 class="sub-title">JS Watchdog</h3>
        

        <h3 class="sub-title">JS Helper</h3>
        

        <h3 class="sub-title">Timer</h3>
        
		DD_MM_YYYY
        <div class="edit-on-github">
            <a target="_blank" href="https://github.com/k-five/jsfun.ir/blob/master/home/effective-javascript-2/inside-the-browser-firefox/main.html">Edit on Github</a>
        </div>
	</div>
</main>
